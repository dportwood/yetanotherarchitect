flowchart LR
  EXT["External Client Systems (SFTP / optional AS2)"] --> TF["AWS Transfer Family Server (VPC-hosted endpoint recommended)"]
  TF --> S3L["S3 Landing Bucket SSE-KMS enforced Object Lock (optional) Versioning"]
  S3L --> GD["GuardDuty Malware Protection for S3 (scan new uploads)"]
  GD --> EVB["EventBridge / S3 Events"]
  EVB --> WF["Step Functions / Lambda Workflow validate filename/schema optional PGP decrypt DLP checks"]
  WF -->|clean| S3C["S3 Clean/Ready Bucket or Prefix"]
  WF -->|failed/quarantine| S3Q["S3 Quarantine Bucket/Prefix restricted access"]
  S3C --> DOWN["Downstream: EKS ingestion jobs Snowflake load (e.g., Snowpipe) Mongo import pipelines"]
